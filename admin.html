<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ELECTRUM ‚Äî –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
    <style>
        :root { --bg: #0f0f0f; --card: #1a1a1a; --accent: #007bff; --text: #e0e0e0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        
        /* –°—Ç–∏–ª–∏ –≤—Ö–æ–¥–∞ */
        .login-box { background: var(--card); padding: 40px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.7); text-align: center; width: 320px; }
        .login-box h2 { margin-bottom: 25px; letter-spacing: 2px; color: var(--accent); }
        input { width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 10px; border: 1px solid #333; background: #111; color: white; box-sizing: border-box; }
        .btn-main { width: 100%; padding: 15px; background: var(--accent); border: none; color: white; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-main:hover { background: #0056b3; transform: scale(1.02); }

        /* –°—Ç–∏–ª–∏ –∞–¥–º–∏–Ω–∫–∏ */
        #admin-content { display: none; width: 95%; max-width: 900px; padding: 20px; }
        .card { background: var(--card); padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #333; }
        .status-ok { color: #2ecc71; font-weight: bold; margin-top: 10px; display: none; }
        
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: #333; border-radius: 8px; cursor: pointer; }
        .tab.active { background: var(--accent); }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="login-screen" class="login-box">
        <h2>ELECTRUM</h2>
        <input type="text" id="user-input" placeholder="–õ–æ–≥–∏–Ω">
        <input type="password" id="pass-input" placeholder="–ü–∞—Ä–æ–ª—å">
        <button class="btn-main" onclick="login()">–í–û–ô–¢–ò –í –°–ò–°–¢–ï–ú–£</button>
        <p id="err" style="color: #ff4d4d; display: none; margin-top: 15px;">–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞</p>
    </div>

    <div id="admin-content">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h1>üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º</h1>
            <button onclick="location.reload()" style="background:none; border:1px solid #444; color:#888; cursor:pointer; border-radius:5px;">–í—ã–π—Ç–∏</button>
        </div>

        <div class="nav-tabs">
            <div class="tab active" onclick="showTab('sections')">üì¶ –†–∞–∑–¥–µ–ª—ã</div>
            <div class="tab" onclick="showTab('items')">üí∞ –°–∫–ª–∞–¥</div>
        </div>

        <div id="sections-part" class="card">
            <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
            <input type="text" id="new-cat" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: VIP)">
            <button class="btn-main" onclick="addCategory()">+ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª</button>
        </div>

        <div id="items-part" class="card hidden">
            <h3>–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
            <input type="text" id="p-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞">
            <input type="number" id="p-price" placeholder="–¶–µ–Ω–∞ (—Ä—É–±)">
            <input type="text" id="p-img" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ (URL)">
            <textarea id="p-desc" style="width:100%; background:#111; color:white; border:1px solid #333; border-radius:10px; padding:10px; margin-bottom:15px;" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
            <select id="p-cat" style="width:100%; padding:12px; background:#111; color:white; border-radius:10px; margin-bottom:15px;"></select>
            <button class="btn-main" onclick="addProduct()">üì¶ –í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —Å–∫–ª–∞–¥</button>
        </div>

        <div id="status" class="status-ok text-center">‚úÖ –°–ò–°–¢–ï–ú–ê –û–ë–ù–û–í–õ–ï–ù–ê</div>
    </div>

    <script>
        const AUTH = { u: "Admin2006", p: "S6gjska68H53H64471" };
        const GITHUB_CONFIG = {
            token: "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",
            repo: "gol131111-ctrl/electrum-",
            file: "db.json"
        };

        function login() {
            const u = document.getElementById('user-input').value;
            const p = document.getElementById('pass-input').value;
            if(u === AUTH.u && p === AUTH.p) {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('admin-content').style.display = 'block';
                document.body.style.alignItems = 'flex-start';
                loadData();
            } else {
                document.getElementById('err').style.display = 'block';
            }
        }

        function showTab(t) {
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
            if(t === 'sections') {
                document.getElementById('sections-part').classList.remove('hidden');
                document.getElementById('items-part').classList.add('hidden');
            } else {
                document.getElementById('sections-part').classList.add('hidden');
                document.getElementById('items-part').classList.remove('hidden');
            }
        }

        async function loadData() {
            const res = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.file}`);
            const data = await res.json();
            const db = JSON.parse(atob(data.content));
            const select = document.getElementById('p-cat');
            select.innerHTML = '';
            db.categories.forEach(c => {
                let opt = document.createElement('option');
                opt.value = c; opt.innerText = c;
                select.appendChild(opt);
            });
            window.currentDB = db;
            window.dbSha = data.sha;
        }

        async function saveData() {
            const content = btoa(unescape(encodeURIComponent(JSON.stringify(window.currentDB, null, 2))));
            await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.file}`, {
                method: 'PUT',
                headers: { 'Authorization': `token ${GITHUB_CONFIG.token}` },
                body: JSON.stringify({ message: "Update DB", content: content, sha: window.dbSha })
            });
            document.getElementById('status').style.display = 'block';
            setTimeout(() => location.reload(), 1500);
        }

        function addCategory() {
            const name = document.getElementById('new-cat').value;
            if(!name) return;
            window.currentDB.categories.push(name);
            saveData();
        }

        function addProduct() {
            const p = {
                id: Date.now(),
                name: document.getElementById('p-name').value,
                price: document.getElementById('p-price').value,
                img: document.getElementById('p-img').value,
                desc: document.getElementById('p-desc').value,
                cat: document.getElementById('p-cat').value
            };
            window.currentDB.products.push(p);
            saveData();
        }
    </script>
</body>
</html>
